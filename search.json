[{"path":[]},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"alpha-diversity","dir":"Articles","previous_headings":"","what":"Alpha diversity","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"aovSMOKINGSTATUS <- aov(Shannon ~ smokingstatus, alphadiv) summary(aovSMOKINGSTATUS) ##                Df Sum Sq Mean Sq F value Pr(>F) ## smokingstatus   4   0.09 0.02162   0.168  0.954 ## Residuals     254  32.62 0.12841 aovSMOKINGSTATUS <- aov(Observed ~ smokingstatus, alphadiv) summary(aovSMOKINGSTATUS) ##                Df  Sum Sq Mean Sq F value Pr(>F)   ## smokingstatus   4   34597    8649    2.12 0.0788 . ## Residuals     254 1036314    4080                  ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 aovSMOKINGSTATUS <- aov(Chao1 ~ smokingstatus, alphadiv) summary(aovSMOKINGSTATUS) ##                Df  Sum Sq Mean Sq F value Pr(>F) ## smokingstatus   4   74507   18627    1.33  0.259 ## Residuals     254 3556471   14002"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"serum-cotinine-vs-smoking-status","dir":"Articles","previous_headings":"","what":"Serum cotinine vs Smoking status","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"ggplot(metadata, aes(smokingstatus, COTININE, fill = smokingstatus)) +    stat_boxplot() +   scale_fill_manual(values = scale_palette) +    theme_bw() +   scale_x_discrete(labels = c(\"Never\\nsmokers\",\"Cigarette\\nsmokers\", \"Former\\nsmokers\",\"Alternative\\nsmokers\",\"Secondhand\\nsmoke\")) +   xlab('Reported smoking status') +   ylab('Serum Cotinine (ng/ml)') +   guides(fill = FALSE) +   theme(strip.background = element_rect(colour = \"transparent\", fill = \"transparent\"),         strip.text.y = element_text(angle = 180),         axis.text = element_text(size = 12),         axis.title = element_text(size = 12),         legend.text = element_text(size=12),         legend.title = element_text(size=12),         legend.position = 'bottom')"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"test-group-with-permanova-adonis-vegan-package","dir":"Articles","previous_headings":"Beta Diversity > Discrete serum blood Cotinine levels","what":"Test group with PERMANOVA (adonis, vegan package)","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## Permutation test for adonis under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ##  ## vegan::adonis2(formula = distwu_2cat ~ COTININE, data = metadata_2cat) ##           Df SumOfSqs      R2      F Pr(>F)     ## COTININE   1  0.07521 0.05028 6.7238  0.001 *** ## Residual 127  1.42048 0.94972                   ## Total    128  1.49569 1.00000                   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"three-categories","dir":"Articles","previous_headings":"Beta Diversity > Discrete serum blood Cotinine levels > Test group with PERMANOVA (adonis, vegan package)","what":"Three categories","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## Permutation test for adonis under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ##  ## vegan::adonis2(formula = distwu_3cat ~ smokingstatus + RACE + GENDER + AGEGRP4C + SR_ACTIVE + EDU3CAT + DBTS_NEW, data = metadata_3cat) ##                Df SumOfSqs      R2      F Pr(>F)     ## smokingstatus   2   0.2232 0.05671 5.2143  0.001 *** ## RACE            4   0.1236 0.03141 1.4438  0.095 .   ## GENDER          1   0.0413 0.01049 1.9296  0.095 .   ## AGEGRP4C        1   0.0528 0.01341 2.4664  0.037 *   ## SR_ACTIVE       2   0.0456 0.01159 1.0657  0.385     ## EDU3CAT         2   0.0483 0.01227 1.1279  0.315     ## DBTS_NEW        1   0.0193 0.00490 0.9009  0.450     ## Residual      158   3.3811 0.85922                   ## Total         171   3.9351 1.00000                   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"all-categories","dir":"Articles","previous_headings":"Beta Diversity > Discrete serum blood Cotinine levels > Test group with PERMANOVA (adonis, vegan package)","what":"All categories","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## Permutation test for adonis under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 999 ##  ## vegan::adonis2(formula = distwu ~ smokingstatus, data = metadata) ##                Df SumOfSqs     R2      F Pr(>F)     ## smokingstatus   4   0.2743 0.0492 3.2857  0.001 *** ## Residual      254   5.3014 0.9508                   ## Total         258   5.5757 1.0000                   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"deseq2","dir":"Articles","previous_headings":"Differential analysis","what":"DESeq2","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"DESeq2 presented sensitivity analysis. Main results calculated edgeR.","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"secondhand-vs-cigarettenever-only-significant-otus","dir":"Articles","previous_headings":"Differential analysis > Cigarette smoker vs Never smoker: crude phylum level","what":"Secondhand vs Cigarette/Never: only significant OTUs","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"function merging smoking cotinine edgeR results: plotting function: Two thresholds serum cotinine: Number OTUs FDR < 0.05 total passed non-specific screens analysis: Correlation crude smoking cotinine coefficients, OTUs: Strict definition second-hand smoke: Correlation crude smoking cotinine coefficients, FDR < 0.05 smoking: OTUs, black FDR < 0.05 smoking coefficients, grey FDR >= 0.05  Repeat, using strict definition second-hand smokers (cotinine < 10)","code":"mergeResults <- function(obj.smoking, obj.cotinine) {   intersect.filters <-     intersect(rownames(obj.smoking), rownames(obj.cotinine))   intersect.filters <- sort(intersect.filters)   obj.smoking <- obj.smoking[intersect.filters, ]   obj.cotinine <- obj.cotinine[intersect.filters, ]   stopifnot(all.equal(rownames(obj.smoking), rownames(obj.cotinine)))   ##   res <-     data.frame(       logFC_smoking = obj.smoking$table$logFC,       logFC_cotinine = obj.cotinine$table$logFC,       FDR_smoking = obj.smoking$table$FDR,       FDR_cotinine = obj.cotinine$table$FDR,       OTU = rownames(obj.smoking$table)     )   res <- cbind(res, obj.smoking[, c(\"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\", \"Species\")])   return(res) } plotSmokingcotinineComparison <-   function(obj.smoking,            obj.cotinine,            labtext = \"Crude\",            FDRcutoff = 1) {     dataset <- mergeResults(obj.smoking, obj.cotinine)     dataset <- dataset[dataset$FDR_smoking < FDRcutoff,]     corr.result <- with(dataset,                         cor.test(logFC_smoking, logFC_cotinine))     p <- ggplot(dataset) +       theme_bw() +       xlab(paste(labtext, \"Smokers vs. Non-smokers\")) +       ylab(paste(labtext, \"Cotinine Levels (ng/ml)\")) +       geom_text(aes(1,-0.3, label = sprintf(         \"p-value: %s\\ncor: %s \\nFDR<0.05: %s\",         signif(corr.result$p.value, 2),         signif(corr.result$estimate, 2),         sum(dataset$FDR_smoking < 0.05)       )), size = 5) +       geom_point(aes(logFC_smoking, logFC_cotinine, color = FDR_smoking <= 0.05),                  size = 3) +       scale_colour_manual(values = setNames(c('black', 'grey'), c(TRUE, FALSE)), guide =                             FALSE) +       geom_smooth(         aes(logFC_smoking, logFC_cotinine),         method = lm,         se = FALSE,         color = \"red\"       ) +       theme(         axis.text = element_text(           hjust = 0,           vjust = 0.5,           size = 13         ),         strip.text = element_text(size = 13),         axis.title = element_text(size = 15)       )     return(p)   } NYC_HANES.secondhand.original <- subset_samples(NYC_HANES, smokingstatus %in% c(\"Secondhand\")) NYC_HANES.secondhand.strict <- subset_samples(NYC_HANES.secondhand.original, COTININE < 10) sort(sample_data(NYC_HANES.secondhand.original)$COTININE) ##  [1]  1.0022  1.0394  1.0418  1.0715  1.0915  1.2015  1.2282  1.2718  1.3822 ## [10]  1.3822  1.4094  1.5315  1.6918  2.0094  2.5994  2.6759  2.8020  2.9394 ## [19]  2.9720  3.0459  3.1082  3.1722  3.4715  3.8394  4.3418  4.5294  4.5394 ## [28]  4.7522  5.7220  6.3118  7.1315  7.7382  9.1118  9.6415 10.2922 10.6920 ## [37] 10.7915 13.7894 summary(sample_data(NYC_HANES.secondhand.original)$COTININE > 10) ##    Mode   FALSE    TRUE  ## logical      34       4 summary(edger.smoker_secondhand_crude$FDR_smoking < 0.05) ##    Mode   FALSE    TRUE  ## logical      93      28 # note that the different total number for strict cotinine cutoff is  # due to non-specific filtering in edgeR summary(edger.smoker_secondhand_crude.strict$FDR_smoking < 0.05) ##    Mode   FALSE    TRUE  ## logical      87      27 corarray <- array(dim=c(2, 2, 2), dimnames=list(secondhand=c(\"cot14\", \"cot10\"),                                                 counfounding=c(\"crude\", \"adjusted\"),                                                 FDRcutoff=c(\"no\", \"yes\"))) parray <- array(dim=c(2, 2, 2), dimnames=list(secondhand=c(\"cot14\", \"cot10\"),                                                 counfounding=c(\"crude\", \"adjusted\"),                                                 FDRcutoff=c(\"no\", \"yes\"))) corr <- with(edger.smoker_secondhand_crude,       cor.test(logFC_smoking, logFC_cotinine)) parray[\"cot14\", \"crude\", \"no\"] <- corr$p.value corarray[\"cot14\", \"crude\", \"no\"] <- corr$estimate corr <- with(edger.smoker_secondhand_crude.strict,       cor.test(logFC_smoking, logFC_cotinine)) parray[\"cot10\", \"crude\", \"no\"] <- corr$p.value corarray[\"cot10\", \"crude\", \"no\"] <- corr$estimate corr <- with(filter(edger.smoker_secondhand_crude, FDR_smoking < 0.05),   cor.test(logFC_smoking, logFC_cotinine)) corarray[\"cot10\", \"crude\", \"yes\"] <- corr$p.value parray[\"cot10\", \"crude\", \"yes\"] <- corr$estimate p <-   plotSmokingcotinineComparison(dasmoking.crude,                                 dacot.crude,                                 labtext = \"Crude\",                                 FDR = 1) p p <-   plotSmokingcotinineComparison(dasmoking.crude,                                 dacot.crude.strict,                                 labtext = \"Crude\",                                 FDR = 1) p"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"adjusted-secondhand-vs-adjusted-cigarettenever-only-significant-otus","dir":"Articles","previous_headings":"Differential analysis > Cigarette smoker vs Never smoker: crude phylum level","what":"Adjusted Secondhand vs Adjusted Cigarette/Never: only significant OTUs","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"Number differentially abundant OTUs, total Correlation adjusted smoking cotinine coefficients, OTUs: , using strict serum cotinine cutoff (<10) Correlation adjusted smoking cotinine coefficients, FDR < 0.05 smoking: Sensitivity analysis:  Repeat, using strict definition second-hand smokers (cotinine < 10)","code":"nrow(edger.smoker_secondhand_adjusted) ## [1] 121 summary(edger.smoker_secondhand_adjusted$logFC_smoking < 0.05) ##    Mode   FALSE    TRUE  ## logical      63      58 summary(edger.smoker_secondhand_adjusted$logFC_cotinine < 0.05) ##    Mode   FALSE    TRUE  ## logical      38      83 corr <- with(edger.smoker_secondhand_adjusted,       cor.test(logFC_smoking, logFC_cotinine)) parray[\"cot14\", \"adjusted\", \"no\"] <- corr$p.value corarray[\"cot14\", \"adjusted\", \"no\"] <- corr$estimate corr <- with(edger.smoker_secondhand_adjusted.strict,       cor.test(logFC_smoking, logFC_cotinine)) parray[\"cot10\", \"adjusted\", \"no\"] <- corr$p.value corarray[\"cot10\", \"adjusted\", \"no\"] <- corr$estimate with(filter(edger.smoker_secondhand_adjusted, FDR_smoking < 0.05),   cor.test(logFC_smoking, logFC_cotinine)) ##  ##  Pearson's product-moment correlation ##  ## data:  logFC_smoking and logFC_cotinine ## t = 3.8131, df = 17, p-value = 0.001391 ## alternative hypothesis: true correlation is not equal to 0 ## 95 percent confidence interval: ##  0.3249855 0.8660843 ## sample estimates: ##       cor  ## 0.6789709 parray[\"cot14\", \"adjusted\", \"yes\"] <- corr$p.value corarray[\"cot14\", \"adjusted\", \"yes\"] <- corr$estimate round(corarray, 2) ## , , FDRcutoff = no ##  ##           counfounding ## secondhand crude adjusted ##      cot14   0.4     0.28 ##      cot10   0.4     0.34 ##  ## , , FDRcutoff = yes ##  ##           counfounding ## secondhand crude adjusted ##      cot14    NA     0.34 ##      cot10     0       NA signif(parray, 1) ## , , FDRcutoff = no ##  ##           counfounding ## secondhand crude adjusted ##      cot14 5e-06    2e-03 ##      cot10 9e-06    3e-04 ##  ## , , FDRcutoff = yes ##  ##           counfounding ## secondhand crude adjusted ##      cot14    NA    3e-04 ##      cot10   0.6       NA p <-   plotSmokingcotinineComparison(     obj.smoking = dasmoking.adjusted,     obj.cotinine = dacot.adjusted,     labtext = \"Adjusted\",     FDRcutoff = 1   ) p p <-   plotSmokingcotinineComparison(     obj.smoking = dasmoking.adjusted,     obj.cotinine = dacot.adjusted.strict,     labtext = \"Adjusted\",     FDRcutoff = 1   ) p"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"write-supplemental-file","dir":"Articles","previous_headings":"Differential analysis > Cigarette smoker vs Never smoker: crude phylum level","what":"Write supplemental file","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"stopifnot(all.equal(rownames(edger.smoker_secondhand_adjusted),                      rownames(edger.smoker_secondhand_crude))) crude <- edger.smoker_secondhand_crude[, 1:4] adjusted <- edger.smoker_secondhand_adjusted[, 1:4] colnames(crude) <- paste0(colnames(crude), \"_crude\") colnames(adjusted) <- paste0(colnames(adjusted), \"_adjusted\") sfile <- cbind(edger.smoker_secondhand_crude[, -1:-4], crude, adjusted) readr::write_excel_csv(sfile, path=\"SupplementalFile1.csv\")"},{"path":[]},{"path":[]},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"cigars-and-cigarillos-vs-never-smokers","dir":"Articles","previous_headings":"Differential analysis > Cigarette smoker vs Never smoker: crude phylum level > Alternative smokers vs Never smoker: crude","what":"Cigars and cigarillos vs never smokers","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## [1] \"No results\""},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"odds-ratio-smokers-vs-never-smokers","dir":"Articles","previous_headings":"Analysis on biosis of bacteria","what":"Odds ratio smokers vs never smokers","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## $tab ##                      ##                      Enriched in smokers        p0 Depleted in smokers ##   OTU is aerobic                      23 0.0362776                  55 ##   OTU is not aerobic                 611 0.9637224                 457 ##                      ##                             p1 oddsratio     lower     upper      p.value ##   OTU is aerobic     0.1074219 1.0000000        NA        NA           NA ##   OTU is not aerobic 0.8925781 0.3127808 0.1894164 0.5164911 2.682452e-06 ##  ## $measure ## [1] \"wald\" ##  ## $conf.level ## [1] 0.95 ##  ## $pvalue ## [1] \"fisher.exact\" ## $tab ##                        ##                        Enriched in smokers        p0 Depleted in smokers ##   OTU is anaerobic                     407 0.6419558                 266 ##   OTU is not anaerobic                 227 0.3580442                 246 ##                        ##                               p1 oddsratio    lower    upper      p.value ##   OTU is anaerobic     0.5195312  1.000000       NA       NA           NA ##   OTU is not anaerobic 0.4804688  1.658143 1.307573 2.102704 3.107853e-05 ##  ## $measure ## [1] \"wald\" ##  ## $conf.level ## [1] 0.95 ##  ## $pvalue ## [1] \"fisher.exact\" ## $tab ##                          ##                          Enriched in smokers        p0 Depleted in smokers ##   OTU is F Anaerobic                     204 0.3217666                 191 ##   OTU is not F Anaerobic                 430 0.6782334                 321 ##                          ##                                 p1 oddsratio    lower    upper    p.value ##   OTU is F Anaerobic     0.3730469 1.0000000       NA       NA         NA ##   OTU is not F Anaerobic 0.6269531 0.7973213 0.624298 1.018298 0.07029177 ##  ## $measure ## [1] \"wald\" ##  ## $conf.level ## [1] 0.95 ##  ## $pvalue ## [1] \"fisher.exact\""},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsea","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Cigarette smokers vs Never smokers","what":"GSEA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET        ES       NES      PVAL ##   <character> <numeric> <numeric> <numeric> ## 1        aero    -0.545     -1.90   0.00378 ## 2        fana    -0.254     -1.08   0.36200"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"ora","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Cigarette smokers vs Never smokers","what":"ORA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## 100 permutations completed ## 200 permutations completed ## 300 permutations completed ## 400 permutations completed ## 500 permutations completed ## 600 permutations completed ## 700 permutations completed ## 800 permutations completed ## 900 permutations completed ## 1000 permutations completed ## DataFrame with 2 rows and 4 columns ##      GENE.SET GLOB.STAT NGLOB.STAT      PVAL ##   <character> <numeric>  <numeric> <numeric> ## 1        aero        13      0.167     0.001 ## 2        fana        17      0.043     0.999"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsea-1","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Secondhand smokers","what":"GSEA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET        ES       NES      PVAL ##   <character> <numeric> <numeric> <numeric> ## 1        fana    -0.288     -1.17     0.233 ## 2        aero    -0.337     -1.21     0.237"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"ora-1","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Secondhand smokers","what":"ORA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## 100 permutations completed ## 200 permutations completed ## 300 permutations completed ## 400 permutations completed ## 500 permutations completed ## 600 permutations completed ## 700 permutations completed ## 800 permutations completed ## 900 permutations completed ## 1000 permutations completed ## DataFrame with 2 rows and 4 columns ##      GENE.SET GLOB.STAT NGLOB.STAT      PVAL ##   <character> <numeric>  <numeric> <numeric> ## 1        fana         1    0.00253     0.001 ## 2        aero         0    0.00000     0.193"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsva-continuous-cotinine-on-secondhand-smokers","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Continuous cotinine","what":"GSVA continuous cotinine on secondhand smokers","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## Estimating GSVA scores for 3 gene sets. ## Estimating ECDFs with Gaussian kernels ##    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% ##             logFC      AveExpr         t   P.Value adj.P.Val         B ## aero 0.0049390950  0.063396833 0.8947032 0.3756454 0.6151923 -7.392942 ## anae 0.0029017486 -0.003614764 0.8313163 0.4101282 0.6151923 -7.447853 ## fana 0.0007153343  0.034927979 0.1784040 0.8591962 0.8591962 -7.781513"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsva-continuous-cotinine-on-cigarette-vs-never-smokers","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Continuous cotinine","what":"GSVA continuous cotinine on cigarette vs never smokers","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## Estimating GSVA scores for 3 gene sets. ## Estimating ECDFs with Gaussian kernels ##    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% ##              logFC     AveExpr         t     P.Value  adj.P.Val          B ## anae  9.312388e-05  0.01061843  2.635005 0.009409142 0.02519808  -8.951131 ## fana -1.031180e-04 -0.02637825 -2.421534 0.016798721 0.02519808  -9.469995 ## aero  9.331210e-05  0.10299623  1.397472 0.164590432 0.16459043 -11.384173"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsea-2","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Hookah smokers vs Never smokers","what":"GSEA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET        ES       NES      PVAL ##   <character> <numeric> <numeric> <numeric> ## 1        fana    -0.246    -1.090     0.347 ## 2        aero    -0.260    -0.962     0.515"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"ora-2","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Hookah smokers vs Never smokers","what":"ORA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET  NR.GENES NR.SIG.GENES      PVAL ##   <character> <numeric>    <numeric> <numeric> ## 1        fana       395            1     0.835 ## 2        aero        78            0     1.000"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsea-3","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > E-cigarette smokers vs Never smokers","what":"GSEA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET        ES       NES      PVAL ##   <character> <numeric> <numeric> <numeric> ## 1        fana    -0.240     -1.03     0.420 ## 2        aero    -0.248     -0.88     0.643"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"ora-3","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > E-cigarette smokers vs Never smokers","what":"ORA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET  NR.GENES NR.SIG.GENES      PVAL ##   <character> <numeric>    <numeric> <numeric> ## 1        aero        78            1     0.303 ## 2        fana       395            1     0.973"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"gsea-4","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Cigar/cigarillos smokers vs Never smokers","what":"GSEA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET        ES       NES      PVAL ##   <character> <numeric> <numeric> <numeric> ## 1        aero    -0.367    -1.280     0.146 ## 2        fana    -0.166    -0.728     0.879"},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/smoking.html","id":"ora-4","dir":"Articles","previous_headings":"Analysis on biosis of bacteria > Cigar/cigarillos smokers vs Never smokers","what":"ORA","title":"Tobacco exposure associated with oral microbiome anaerobiosis in the New York City Health and Nutrition Examination Study (NYC HANES) II","text":"","code":"## DataFrame with 2 rows and 4 columns ##      GENE.SET  NR.GENES NR.SIG.GENES      PVAL ##   <character> <numeric>    <numeric> <numeric> ## 1        fana       395            3     0.582 ## 2        aero        78            0     1.000 sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] edgeR_3.42.4             limma_3.56.2             ggplot2_3.4.3            ##  [4] magrittr_2.0.3           dplyr_1.1.3              nychanesmicrobiome_0.1.2 ##  [7] lsr_0.5.2                phyloseq_1.44.0          Biobase_2.60.0           ## [10] BiocGenerics_0.46.0      BiocStyle_2.28.0         ##  ## loaded via a namespace (and not attached): ##   [1] splines_4.3.1               bitops_1.0-7                ##   [3] tibble_3.2.1                R.oo_1.25.0                 ##   [5] graph_1.78.0                XML_3.99-0.14               ##   [7] lifecycle_1.0.3             doParallel_1.0.17           ##   [9] rprojroot_2.0.3             lattice_0.21-8              ##  [11] vroom_1.6.3                 MASS_7.3-60                 ##  [13] survey_4.2-1                sass_0.4.7                  ##  [15] rmarkdown_2.24              jquerylib_0.1.4             ##  [17] yaml_2.3.7                  DBI_1.1.3                   ##  [19] RColorBrewer_1.1-3          ade4_1.7-22                 ##  [21] abind_1.4-5                 zlibbioc_1.46.0             ##  [23] Rtsne_0.16                  GenomicRanges_1.52.0        ##  [25] purrr_1.0.2                 R.utils_2.12.2              ##  [27] RCurl_1.98-1.12             circlize_0.4.15             ##  [29] labelled_2.12.0             GenomeInfoDbData_1.2.10     ##  [31] IRanges_2.34.1              S4Vectors_0.38.1            ##  [33] irlba_2.3.5.1               GSVA_1.48.3                 ##  [35] vegan_2.6-4                 microbiome_1.22.0           ##  [37] annotate_1.78.0             DelayedMatrixStats_1.22.6   ##  [39] pkgdown_2.0.7               permute_0.9-7               ##  [41] codetools_0.2-19            DelayedArray_0.26.7         ##  [43] tidyselect_1.2.0            shape_1.4.6                 ##  [45] farver_2.1.1                ScaledMatrix_1.8.1          ##  [47] epitools_0.5-10.1           matrixStats_1.0.0           ##  [49] stats4_4.3.1                jsonlite_1.8.7              ##  [51] GetoptLong_1.0.5            multtest_2.56.0             ##  [53] e1071_1.7-13                survival_3.5-5              ##  [55] iterators_1.0.14            systemfonts_1.0.4           ##  [57] foreach_1.5.2               tools_4.3.1                 ##  [59] ragg_1.2.5                  Rcpp_1.0.11                 ##  [61] glue_1.6.2                  xfun_0.40                   ##  [63] mgcv_1.8-42                 DESeq2_1.40.2               ##  [65] MatrixGenerics_1.12.3       GenomeInfoDb_1.36.2         ##  [67] HDF5Array_1.28.1            withr_2.5.0                 ##  [69] BiocManager_1.30.22         fastmap_1.1.1               ##  [71] mitools_2.4                 rhdf5filters_1.12.1         ##  [73] fansi_1.0.4                 SparseM_1.81                ##  [75] rsvd_1.0.5                  digest_0.6.33               ##  [77] R6_2.5.1                    textshaping_0.3.6           ##  [79] colorspace_2.1-0            RSQLite_2.3.1               ##  [81] R.methodsS3_1.8.2           utf8_1.2.3                  ##  [83] tidyr_1.3.0                 generics_0.1.3              ##  [85] data.table_1.14.8           class_7.3-22                ##  [87] httr_1.4.7                  S4Arrays_1.0.6              ##  [89] pkgconfig_2.0.3             gtable_0.3.4                ##  [91] blob_1.2.4                  ComplexHeatmap_2.16.0       ##  [93] SingleCellExperiment_1.22.0 XVector_0.40.0              ##  [95] htmltools_0.5.6             bookdown_0.35               ##  [97] biomformat_1.28.0           GSEABase_1.62.0             ##  [99] clue_0.3-64                 scales_1.2.1                ## [101] png_0.1-8                   knitr_1.43                  ## [103] tzdb_0.4.0                  reshape2_1.4.4              ## [105] rjson_0.2.21                nlme_3.1-162                ## [107] proxy_0.4-27                cachem_1.0.8                ## [109] zoo_1.8-12                  rhdf5_2.44.0                ## [111] GlobalOptions_0.1.2         stringr_1.5.0               ## [113] safe_3.40.1                 parallel_4.3.1              ## [115] AnnotationDbi_1.62.2        desc_1.4.2                  ## [117] pillar_1.9.0                grid_4.3.1                  ## [119] vctrs_0.6.3                 BiocSingular_1.16.0         ## [121] beachmat_2.16.0             xtable_1.8-4                ## [123] cluster_2.1.4               Rgraphviz_2.44.0            ## [125] evaluate_0.21               KEGGgraph_1.60.0            ## [127] readr_2.1.4                 cli_3.6.1                   ## [129] locfit_1.5-9.8              compiler_4.3.1              ## [131] rlang_1.1.1                 crayon_1.5.2                ## [133] tableone_0.13.2             labeling_0.4.3              ## [135] plyr_1.8.8                  forcats_1.0.0               ## [137] fs_1.6.3                    stringi_1.7.12              ## [139] BiocParallel_1.34.2         munsell_0.5.0               ## [141] Biostrings_2.68.1           Matrix_1.5-4.1              ## [143] sas7bdat_0.7                hms_1.1.3                   ## [145] sparseMatrixStats_1.12.2    bit64_4.0.5                 ## [147] Rhdf5lib_1.22.0             KEGGREST_1.40.0             ## [149] statmod_1.5.0               SummarizedExperiment_1.30.2 ## [151] highr_0.10                  haven_2.5.3                 ## [153] igraph_1.5.1                memoise_2.0.1               ## [155] bslib_0.5.1                 bit_4.0.5                   ## [157] EnrichmentBrowser_2.30.2    ape_5.7-1"},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"table-1-demographics-descriptive-statistics","dir":"Articles","previous_headings":"Descriptives","what":"Table 1: Demographics & Descriptive Statistics","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Table 1. Sample demographics oral health behavioral characteristics.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"checking-collinearity-using-cramers-v","dir":"Articles","previous_headings":"Descriptives","what":"Checking collinearity using Cramer’s V","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Examining collinearity among sociodemographic variables. Data absolute value pairwise Cramer’s V correlation coefficient sociodemographic factor levels. Data full sample (n=1,527) New York City Health Nutrition Examination Survey, 2013-2014. Abbreviations: cat=categories; US=United States..","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"abundance","dir":"Articles","previous_headings":"Descriptives","what":"Abundance","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Genus- phylum-level relative abundances. Data percent overall communities within samples, summarized mean ± standard deviation percent across samples. Data oral microbiome subsample (n=296) New York City Health Nutrition Examination Survey, 2013-2014.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"alpha-diversity","dir":"Articles","previous_headings":"","what":"Alpha Diversity","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Alpha diversity Sociodemographic Characteristics. Chao1 alpha diversity 16S rRNA oral microbiome samples. Measures compared using null hypothesis difference groups (Kruskal-Wallis test, p > 0.1 tests). Data oral microbiome subsample (n=296) New York City Health Nutrition Examination Survey, 2013-2014. Abbreviations: GED=General equivalency diploma; PR=Puerto Rico; US=United States.","code":""},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"tileplot","dir":"Articles","previous_headings":"edgeR Differential Abundance","what":"Tileplot","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Differential abundance sociodemographic characteristics. OTUs () oligotypes (B) meeting unadjusted FDR <0.01 negative binomial log-linear GLMs using edgeR. Filled tiles () indicate genus least one OTU differentially abundant least one coefficient contrast within sociodemographic factor. commonly differential genera () included Prevotella (n=8) Lactobacillus (n=7).","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"boxplots-of-crude-vs--adjusted","dir":"Articles","previous_headings":"edgeR Differential Abundance","what":"Boxplots of crude vs. adjusted","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Distribution absolute values log-fold change (logFC). Values crude adjusted edgeR models OTUs meeting FDR<0.01 crude model, sociodemographic variable.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"table-2--differential-abundance-findings-for-otus-selected-based-on-clinical-relevance--greater-or-lower-abundance-indicates-false-discovery-rate-fdr-0-01-","dir":"Articles","previous_headings":"edgeR Differential Abundance","what":"Table 2. Differential abundance findings for OTUs selected based on clinical relevance. Greater or lower abundance indicates false discovery rate (FDR) <0.01.","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Table 2. Differential abundance findings OTUs selected based clinical relevance. Greater lower abundance indicates false discovery rate (FDR) <0.01. [1] “Reference groups sociodemographic variables follows: Gender: Male, Age: 20-34, Education: College Graduate , Family income: $60,000 , Marital status: Married, Race/ethnicity: Non-Hispanic White, US- vs. foreign-born: US-Born, 50 States, DC, PR Territories”","code":""},{"path":[]},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"within--vs--between-group-beta-diversity-boxplots","dir":"Articles","previous_headings":"PERMANOVA / Beta diversity","what":"Within- vs. between-group beta diversity boxplots","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Within group beta diversity estimate distributions.","code":""},{"path":[]},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"abstract","dir":"Articles","previous_headings":"Manuscript Text Elements","what":"Abstract","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"Background Variations oral microbiome potentially implicated health inequalities, existing studies oral microbiome minimal sociodemographic diversity. describe sociodemographic variation oral microbiome diverse sample.Methods subsample (n=282) 2013-14 population-based New York City Health Nutrition Examination Study (NYC-HANES). Mouthwash samples processed using using 16S v4 rRNA amplicon sequencing. examined differential abundance 216 operational taxonomic units (OTUs), addition alpha beta diversity sociodemographic variables including age, sex, income, education, nativity, race/ethnicity. Results 69 OTUs differentially abundant sociodemographic variable (false discovery rate < 0.01), including 27 race/ethnicity, 21 family income, 19 education, three sex. found 67 smoking status, 18 sugar-sweetened beverage consumption, nine mouthwash use. Genera differing multiple sociodemographic characteristics included Lactobacillus, Prevotella, Porphyromonas, Fusobacterium.Discussion identified variations oral microbiome consistent health inequalities, taxa differing race/ethnicity sugar-sweetened beverage consumption, SES variables mouthwash use. investigation warranted possible mediating effects oral microbiome social disparities diabetes, inflammation, oral health, preterm birth.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"results","dir":"Articles","previous_headings":"Manuscript Text Elements","what":"Results","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"initial subsample included 297 participants; removing samples less 1000 reads, 282 participants remaining analysis. Table 1 shows sociodemographic variation final analytic sample respect age (median [range]: 42 [20 94]), gender (53.2% female), race/ethnicity (34.4% non-Hispanic White, 26.6% non-Hispanic Black, 25.2% Hispanic), annual family income (42.7% less $30K, 33.3% $60k ), educational achievement (23.0% less high school diploma, 30.9% college degree greater). Cramer’s V pairwise combinations sociodemographic variables indicated minor collinearity (V<.35) (Supplemental Figure 1). Relative Abundance Alpha Diversity Oral microbiomes characterized phylum level gradient Firmicutes Bacteroides abundance, overall dominance Firmicutes (mean=52±10%). Streptococcus abundant genus (36±10%) followed Prevotella (17±8%). (Figure 1). overall mean chao1 462±118, differences age group (p=0.79), gender NA, educational achievement (p=0.92), annual family income (p=0.62), marital status (p=0.54), race/ethnicity (p=0.13), nativity (p=0.97, Figure 3). (Supplemental Figure 2) Differential Abundance Oligotyping Numerous taxa differentially abundant race/ethnicity, nativity, marital status, gender, family income tertiles, education, age groups. Figure 2a displays log fold change (logFC), coefficient edgeR log linear models, comparison group significant OTUs. total 69 OTUs differentially abundant sociodemographic variable, including 56 age group, 27 race/ethnicity, 21 family income, 19 education, 19 marital status, seven nativity, three gender. also found nine mouthwash use, five self-reported gum disease, 67 smoking status, 18 sugar-sweetened beverage consumption. frequently differentially abundant Lactobacillus (variables), Prevotella (age, education, family income, marital status, race/ethnicity, nativity, Figure 2a) Differential abundance findings selected taxa presented Table 2. numerous associations present FDR<0.01, focus findings logFC 2 greater. Compared individuals aged 20-34, individuals aged 65 displayed greater abundance Lactobacillus (logFC 2.9, FDR <0.0001), Lactococcus (logFC 2.5, FDR 0.001), Bifidobacterium (logFC 2.1, FDR 0.0002), Scardovia (logFC 2.1, FDR 0.0005). Compared individuals college degree greater, high school diploma less showed greater abundance Pseudomonas (logFC 2, FDR 0.006), college associate’s degree showed greater abundance Lactococcus (logFC 3, FDR <0.0001), Lactobacillus (logFC 2.7, FDR <0.0001), Scardovia (logFC 2.6, FDR <0.0001), Anaeroglobus (logFC 2.1, FDR 0.004). Individuals annual family incomes $30,000 $60,000 greater abundance Lactobacillus (logFC 2.5, FDR <0.0001), Scardovia (logFC 2.5, FDR <0.0001), Bifidobacterium (logFC 2.4, FDR <0.0001), Atopobium (logFC 2.2, FDR 0.0005), compared making less $30,000. Marital status showed large number strong associations: compared married, living partner showed greater abundance Atopobium (logFC 2.3, FDR 0.002), Prevotella (logFC 2.2, FDR 0.002), separated showed greater abundance Leptotrichia (logFC 3, FDR 0.002), widowed, greater abundance Pseudomonas (logFC 4.1, FDR <0.0001), Candidatus Saccharimonas (logFC 2, FDR <0.0001). Compared non-Hispanic whites, non-Hispanic Blacks greater abundance Lactococcus (logFC 2.9, FDR <0.0001), Anaeroglobus (logFC 2.3, FDR <0.0001), Atopobium (logFC 2.2, FDR <0.0001), Lactobacillus (logFC 2.1, FDR <0.0001), Campylobacter (logFC 2, FDR <0.0001). Figure 3 displays distribution logFCs crude adjusted, including OTUs FDR <0.01 crude models. Adjusting smoking, mouthwash use, age gender, minor effect crude estimates; however, adjustment smoking exerts largest effect findings age, income education. Analyzing oligotypes Neisseria, Prevotella, Streptococcus revealed associations apparent OTU analysis, whereas associations present OTU analysis apparent oligotypes (Figure 2). New associations revealed Prevotella gender, Streptococcus gender, race/ethnicity nativity, Neisseria gender, age, education, marital status, race/ethnicity nativity. Associations present OTUs oligotyping age, education income Prevotella, income Neisseria.  Oligotype associations within Neisseria marital status, race/ethnicity, nativity mutually exclusive set taxa, associations gender Neisseria, Prevotella, Streptococcus separate taxa associations sociodemographic variables. Age group education unidirectional associations OTU analysis Streptococcus bidirectional differential abundance oligotypes. Prevotella, race/ethnicity unidirectional associations OTU analysis bidirectional associations oligotypes.Beta Diversity Clustering Figure 4 illustrates -versus within-group weighted UniFrac distances sociodemographic variable. observed overall shifts composition age group (p=0.017 \\(r^2\\)=0.025), education (p=0.017 \\(r^2\\)=0.025), nativity (p=0.017 \\(r^2\\)=0.025), variables showing greater - within-group variation. Plots first two principal coordinates based weighted UniFrac distances showed little patterning variable (shown). Clustering scores sensitive distance metric used, Bray-Curtis indicating moderate support 2 clusters (PS=0.86), measures providing little support clustering.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"discussion","dir":"Articles","previous_headings":"Manuscript Text Elements","what":"Discussion","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"diverse population-based sample, found large number bacterial taxa differentially abundant age group, race/ethnicity, family income, education, nativity, gender. Notably, found greater number associations SES variables (21 family income, 19 education) gender, marital status nativity. associations SES mouthwash use (nine ) gum disease (five ), similar number associations found sugar-sweetened beverage use (18 ). Sociodemographic associations appreciably diminished adjustment factors. also found differential abundance sociodemographic characteristics differed oligotyping vs. OTUs, especially Neisseria. Alpha diversity similar across groups, beta diversity explained small proportion variance age (2.9%), education 2.5%), nativity 1%), less variables. found poor support clustering samples OTUs, , similarly Koren et al. (2013) (52), clustering findings sensitive distance metric employed.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/articles/social-epi.html","id":"sessioninfo","dir":"Articles","previous_headings":"","what":"SessionInfo()","title":"NYC-HANES2 Social Epidemiology of the Oral Microbiome","text":"run edgeR comparing current cigarette vs. never smokers, get 46 significant OTUs FDR < 0.05, run DESeq2, get 48.","code":"#> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] edgeR_3.42.4             limma_3.56.2             nychanesmicrobiome_0.1.2 #>  [4] lsr_0.5.2                Biobase_2.60.0           BiocGenerics_0.46.0      #>  [7] ggplot2_3.4.3            magrittr_2.0.3           dplyr_1.1.3              #> [10] vegan_2.6-4              lattice_0.21-8           permute_0.9-7            #> [13] ape_5.7-1                phyloseq_1.44.0          BiocStyle_2.28.0         #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.1.3               bitops_1.0-7            gridExtra_2.3           #>   [4] rlang_1.1.1             ade4_1.7-22             e1071_1.7-13            #>   [7] compiler_4.3.1          mgcv_1.8-42             systemfonts_1.0.4       #>  [10] vctrs_0.6.3             reshape2_1.4.4          rvest_1.0.3             #>  [13] stringr_1.5.0           pkgconfig_2.0.3         crayon_1.5.2            #>  [16] fastmap_1.1.1           XVector_0.40.0          labeling_0.4.3          #>  [19] utf8_1.2.3              rmarkdown_2.24          haven_2.5.3             #>  [22] ragg_1.2.5              purrr_1.0.2             xfun_0.40               #>  [25] zlibbioc_1.46.0         cachem_1.0.8            labelled_2.12.0         #>  [28] GenomeInfoDb_1.36.2     jsonlite_1.8.7          biomformat_1.28.0       #>  [31] highr_0.10              sas7bdat_0.7            rhdf5filters_1.12.1     #>  [34] Rhdf5lib_1.22.0         parallel_4.3.1          cluster_2.1.4           #>  [37] R6_2.5.1                RColorBrewer_1.1-3      bslib_0.5.1             #>  [40] stringi_1.7.12          jquerylib_0.1.4         Rcpp_1.0.11             #>  [43] bookdown_0.35           iterators_1.0.14        knitr_1.43              #>  [46] zoo_1.8-12              IRanges_2.34.1          Matrix_1.5-4.1          #>  [49] splines_4.3.1           igraph_1.5.1            tidyselect_1.2.0        #>  [52] rstudioapi_0.15.0       yaml_2.3.7              codetools_0.2-19        #>  [55] tibble_3.2.1            plyr_1.8.8              withr_2.5.0             #>  [58] evaluate_0.21           desc_1.4.2              survival_3.5-5          #>  [61] proxy_0.4-27            survey_4.2-1            xml2_1.3.5              #>  [64] Biostrings_2.68.1       pillar_1.9.0            BiocManager_1.30.22     #>  [67] foreach_1.5.2           stats4_4.3.1            generics_0.1.3          #>  [70] rprojroot_2.0.3         RCurl_1.98-1.12         S4Vectors_0.38.1        #>  [73] hms_1.1.3               munsell_0.5.0           scales_1.2.1            #>  [76] class_7.3-22            glue_1.6.2              tools_4.3.1             #>  [79] data.table_1.14.8       webshot_0.5.5           locfit_1.5-9.8          #>  [82] forcats_1.0.0           fs_1.6.3                rhdf5_2.44.0            #>  [85] grid_4.3.1              mitools_2.4             colorspace_2.1-0        #>  [88] nlme_3.1-162            GenomeInfoDbData_1.2.10 cli_3.6.1               #>  [91] kableExtra_1.3.4        textshaping_0.3.6       fansi_1.0.4             #>  [94] viridisLite_0.4.2       svglite_2.1.1           gtable_0.3.4            #>  [97] tableone_0.13.2         sass_0.4.7              digest_0.6.33           #> [100] farver_2.1.1            memoise_2.0.1           htmltools_0.5.6         #> [103] pkgdown_2.0.7           multtest_2.56.0         lifecycle_1.0.3         #> [106] httr_1.4.7              MASS_7.3-60"},{"path":"http://waldronlab.io/nychanesmicrobiome/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Audrey Renson. Maintainer.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"<lwaldron.research@gmail.com> ARFB<LW (2023). nychanesmicrobiome: Analysis NYC-HANES Microbiome Specimens. R package version 0.1.2, http://waldronlab.io/nychanesmicrobiome/.","code":"@Manual{,   title = {nychanesmicrobiome: Analysis of the NYC-HANES Microbiome Specimens},   author = {Audrey Renson Francesco Beghini  Levi Waldron },   year = {2023},   note = {R package version 0.1.2},   url = {http://waldronlab.io/nychanesmicrobiome/}, }"},{"path":"http://waldronlab.io/nychanesmicrobiome/index.html","id":"microbiome-analysis-of-the-nyc-hanes-study","dir":"","previous_headings":"","what":"Analysis of the NYC-HANES Microbiome Specimens","title":"Analysis of the NYC-HANES Microbiome Specimens","text":"reproduce analysis, need two packages CRAN (www.cran.r-project.org). install R command line: can install package build vignettes follows: machines, command may default install required dependencies. happens , can install nychanesmicrobiome package dependencies follows: installing nychanesmicrobiome package, load : see code results previous analyses : nychanesmicrobiome package loaded, able reproduce code found “vignette” analyses. nychanesmicrobiome package provides number documented functions analysing dataset. functions defined package keep analysis scripts cleaner separate components used multiple analysts: particular, loadQiimeData() import NYC HANES microbiome data phyloseq object, including cleaning merging participant data microbiome data.","code":"install.packages(c(\"BiocManager\", \"devtools\")) BiocManager::install(“waldronlab/nychanesmicrobiome”) BiocManager::install(c(\"waldronlab/nychanesmicrobiome\", \"phyloseq\", \"lsr\", \"sas7bdat\", \"kableExtra\",            \"ggplot2\", \"IHW\", \"dplyr\", \"epitools\", \"statmod\", \"DESeq2\", \"edgeR\", \"GSVA\",            \"EnrichmentBrowser\", \"magrittr\", \"dplyr\", \"vegan\", \"reshape2\", \"BiocStyle\")) library(nychanesmicrobiome) browseVignettes(\"nychanesmicrobiome\") help(package=\"nychanesmicrobiome\")"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/annotateFactors.html","id":null,"dir":"Reference","previous_headings":"","what":"Format sample data files as needed for sociodemographic and smoking analyses. — annotateFactors","title":"Format sample data files as needed for sociodemographic and smoking analyses. — annotateFactors","text":"Format sample data files needed sociodemographic smoking analyses.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/annotateFactors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format sample data files as needed for sociodemographic and smoking analyses. — annotateFactors","text":"","code":"annotateFactors(NYC_HANES)  annotateFullDataset(dat)  formatMetadata(dat)"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/annotateFactors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format sample data files as needed for sociodemographic and smoking analyses. — annotateFactors","text":"NYC_HANES object class pseq. dat Data.frame.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/annotateFactors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Format sample data files as needed for sociodemographic and smoking analyses. — annotateFactors","text":"convenience functions accomplish recoding formatting sample data consistency across sociodemographics smoking analyses.  annotateFactors formats phyloseq object n=297 pilot study, annotateFullDataset formats full NYC HANES data.frame. formatMetadata produces dataset factor levels represent nice-looking labels sociodemographics variables used plotting tables.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/get_edgeR_results.html","id":null,"dir":"Reference","previous_headings":"","what":"User friendly interface to edgeR for microbiome data — get_edgeR_results","title":"User friendly interface to edgeR for microbiome data — get_edgeR_results","text":"Returns object class topTags containing results filtered FDR < alpha one comparison. get_edgeR_results_all_levels() returns list topTags objects returned get_edgeR_results() levels first variable formula.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/get_edgeR_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"User friendly interface to edgeR for microbiome data — get_edgeR_results","text":"","code":"get_edgeR_results(   formla,   pseq = NYC_HANES,   method = c(\"BH\", \"IHW\"),   coef = 2,   alph = 0.01,   filtering = method[1] == \"BH\",   countMinimum = 8,   percentMinimumHaveCount = NULL,   nMinimumHaveCount = 3,   NA.RM = TRUE )  get_edger_results_all_levels(formla, ...)  edger_list_to_data.frame(list_models)  get_all_edgeR_models(   vars,   varlabels = vars,   adjusted_for,   to.data.frame = TRUE,   ... )"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/get_edgeR_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"User friendly interface to edgeR for microbiome data — get_edgeR_results","text":"formla formula. specifies design matrix used edgeR::glmFit. pseq object class phyloseq method character. Specifies method multiple testing correction apply, either \"BH\" (Benjamini-Hochberg) \"IHW\" (independent hypothesis weighting). coef integer. Specifies linear model coefficient test (default 2). alph numeric. Specifies FDR level considered alpha, keeps results FDR less number. filtering logical. Whether apply pre-filtering. countMinimum integer. filtering==TRUE, minimum count required OTU retained. Requires either percentMinimumHaveCount nMinimumHaveCount. percentMinimumHaveCount numeric. filtering==TRUE, minimum percentage samples must countMinimum counts OTU retained. nMinimumHaveCount numeric. filtering==TRUE, minimum number samples must countMinimum counts OTU retained. NA.RM logical. Whether remove samples NA values sample_data(). ... arguments passed get_edgeR_results vars character vector, containing names independent variable like separate model. varlabels character vector, containing variable labels printing adjusted_for character vector, containing names additional adjustment variables include model .data.frame logical. Whether return combined data.frame model results, rather default list.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/loadQiimeData.html","id":null,"dir":"Reference","previous_headings":"","what":"Import — loadQiimeData","title":"Import — loadQiimeData","text":"loadQiimeData imports NYC HANES-II microbiome data  phyloseq object","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/loadQiimeData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Import — loadQiimeData","text":"","code":"loadQiimeData()"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/loadQiimeData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Import — loadQiimeData","text":"phyloseq object.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/loadQiimeData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Import — loadQiimeData","text":"","code":"nychanes <- loadQiimeData() #> Warning: unable to translate 'lexical error: invalid char in json text. #>                                        <89>HDF                        (right here) ------^ #> ' to a wide string #> Warning: input string 1 is invalid"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_abundance.html","id":null,"dir":"Reference","previous_headings":"","what":"Area and bar plots of sample-level relative abundance at specified taxonomic levels — plot_abundance","title":"Area and bar plots of sample-level relative abundance at specified taxonomic levels — plot_abundance","text":"Area bar plots sample-level relative abundance specified taxonomic levels","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_abundance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Area and bar plots of sample-level relative abundance at specified taxonomic levels — plot_abundance","text":"","code":"plot_abundance(   pseq,   top_n = 8,   taxrank = \"Phylum\",   prop_of = \"top_n\",   type = \"area\",   orderby_OTU,   PALETTE )  plot_abundance_by(   pseq,   brewerpal = \"Set1\",   by,   type = c(\"area\", \"bar\"),   ttle = paste0(\"Relative phylum abundances by \", by) )"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_abundance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Area and bar plots of sample-level relative abundance at specified taxonomic levels — plot_abundance","text":"pseq object class phyloseq top_n Integer. Number taxonomic groups display, sorted relative abundance taxrank Character. Taxonomic rank display. column name taxa_table pseq. prop_of Character. Either \"top_n\" \"total\". Indicates whether heights area/bars represent proportion displayed taxonomic groups, total. type Character. Either area bar, specifying type plot. Area displays samples left right, whereas bars give mean abundances. orderby_OTU Character (optional). OTU name (.e. rowname otu_table) whose relative abundance like sort . creates visual gradient left right , say, Firmicutes. PALETTE Character length top_n palette area bar chart. brewerpal Character. Name RColorBrewer palette use. Character. Variable sample_data stratify plots . ttle Character. Plot title.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_alpha_by.html","id":null,"dir":"Reference","previous_headings":"","what":"Alpha and beta diversity plots stratified by sample variables — plot_alpha_by","title":"Alpha and beta diversity plots stratified by sample variables — plot_alpha_by","text":"Alpha beta diversity plots stratified sample variables","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_alpha_by.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alpha and beta diversity plots stratified by sample variables — plot_alpha_by","text":"","code":"plot_alpha_by(   pseq,   vars,   metadata = sample_data(pseq)[, vars],   notch = TRUE,   adjust_formula,   alpha_p )  plot_beta_by(pseq, vars, dist_mtrx)"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_alpha_by.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alpha and beta diversity plots stratified by sample variables — plot_alpha_by","text":"pseq object class phyloseq vars Character vector. Names variables sample_data stratify . metadata Data.frame. Defaults sample_data(pseq)[,vars], allows use say, calculated variable without modify pseq. notch Logical. Whether return notched boxplots. dist_mtrx Matrix. Matrix -group distances, e.g. returned phyloseq::distance().","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_edgeR.html","id":null,"dir":"Reference","previous_headings":"","what":"Dot plots based on edgeR results for microbiome data — plot_edgeR","title":"Dot plots based on edgeR results for microbiome data — plot_edgeR","text":"Plots results get_edgeR_results_all_levels() using ggplot2 engine.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_edgeR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dot plots based on edgeR results for microbiome data — plot_edgeR","text":"","code":"plot_edgeR(   formla,   ttle = NULL,   varname = NULL,   pseq = NYC_HANES,   coef = 2,   printIfEmpty = FALSE,   invisbl = FALSE,   color = \"FDR\",   sortby = NULL,   ... )"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/plot_edgeR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dot plots based on edgeR results for microbiome data — plot_edgeR","text":"formla formula. specifies design matrix used edgeR::glmFit. ttle character. Title plot. varname character. Label independent variable, plotting. pseq object class phyloseq coef integer. Specifies linear model coefficient test (default 2). printIfEmpty logical. results pass alpha, whether plot empty plot. invisbl logical. Whether forgoe plotting. Either way, invisibly returns topTags object returned get_edgeR_results. color character. Variable  color , either tax_table topTags$table. sortby character. Variable sort plot , either tax_table topTags$table. ... arguments passed get_edgeR_results.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/prettytable_autoindent.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an auto-indented table based on tableone::CreateTableOne. — prettytable_autoindent","title":"Create an auto-indented table based on tableone::CreateTableOne. — prettytable_autoindent","text":"Create auto-indented table based tableone::CreateTableOne.","code":""},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/prettytable_autoindent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an auto-indented table based on tableone::CreateTableOne. — prettytable_autoindent","text":"","code":"prettytable_autoindent(   vars,   data,   nspaces = 6,   includeNA = TRUE,   nonnormal = NULL,   ... )"},{"path":"http://waldronlab.io/nychanesmicrobiome/reference/prettytable_autoindent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an auto-indented table based on tableone::CreateTableOne. — prettytable_autoindent","text":"vars Character vector. Names variables summarize data Data.frame. search vars. nspaces Integer. Number spaces add beginning indented rows. includeNA Logical. Whether treat NAs factor level. nonnormal Character vector. Names variables vars treat non-normally distributed summary test functions. ... Arguments passed CreateTableOne","code":""}]
